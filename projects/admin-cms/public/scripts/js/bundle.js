(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getFieldValue = (id) => document.getElementById(id).value;

},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });

},{}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const request_1 = require("./request");
const helpers_1 = require("./helpers");
const screenshotsParentNode = document.querySelector("#screenshots__list");
const iconParentNode = document.querySelector(".icon");
let iconURL = "";
let screenshotURLs = [];
document
    .querySelector("#screenshots")
    .addEventListener("change", async (e) => {
    const { target: { files } } = e;
    const formData = new FormData();
    for (let i = 0; i < files.length; i++) {
        formData.append("files", files[i]);
    }
    try {
        const response = await request_1.UPLOAD(formData);
        const { urls } = await response;
        screenshotURLs = urls;
        drawScreenshotList(screenshotsParentNode, screenshotURLs);
    }
    catch (error) {
        console.error(error);
    }
});
document
    .querySelector("#icon")
    .addEventListener("change", async (e) => {
    const { target: { files } } = e;
    const formData = new FormData();
    formData.append("files", files[0]);
    try {
        const data = await request_1.UPLOAD(formData);
        const { urls: [url] } = data;
        iconURL = url;
        drawIcon(iconParentNode, url);
    }
    catch (error) {
        console.error(error);
    }
});
document.querySelector(".new-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    try {
        const data = JSON.stringify({
            title: helpers_1.getFieldValue("title"),
            description: helpers_1.getFieldValue("description"),
            googleLink: helpers_1.getFieldValue("google-link"),
            icon: iconURL,
            screenshots: screenshotURLs
        });
        await request_1.POST("/projects", data);
        location.href = "/";
    }
    catch (error) {
        console.log(error);
    }
});
const drag = (e, url) => e.dataTransfer.setData("text", JSON.stringify(url));
const drop = (e, currentURL) => {
    e.preventDefault();
    const newURL = JSON.parse(e.dataTransfer.getData("text"));
    const newScreenshotURLS = screenshotURLs.map((url, index) => {
        if (index === newURL.index) {
            return currentURL.url;
        }
        if (index === currentURL.index) {
            return newURL.url;
        }
        return url;
    });
    screenshotURLs = [...newScreenshotURLS];
    drawScreenshotList(screenshotsParentNode, newScreenshotURLS);
};
const drawScreenshotList = (screenshotsNode, urls) => {
    while (screenshotsNode.firstChild) {
        screenshotsNode.removeChild(screenshotsNode.firstChild);
    }
    urls.forEach((url, index) => {
        const node = document.createElement("div");
        const imgNode = document.createElement("img");
        node.classList.add("col-6", "col-md-3", "screenshots__list__item", `screenshots__list__item__${index}`);
        node.draggable = true;
        imgNode.src = url;
        imgNode.alt = "screenshot";
        node.appendChild(imgNode);
        screenshotsNode.appendChild(node);
        document
            .querySelector(`.screenshots__list__item__${index}`)
            .addEventListener("dragstart", (e) => drag(e, { index, url }));
        document
            .querySelector(`.screenshots__list__item__${index}`)
            .addEventListener("drop", (e) => drop(e, { index, url }));
        document
            .querySelector(`.screenshots__list__item__${index}`)
            .addEventListener("dragover", (e) => e.preventDefault());
    });
};
const drawIcon = (iconNode, url) => {
    while (iconNode.firstChild) {
        iconNode.removeChild(iconNode.firstChild);
    }
    const imgNode = document.createElement("img");
    imgNode.classList.add("icon__item");
    imgNode.src = url;
    imgNode.alt = "screenshot";
    iconNode.appendChild(imgNode);
};

},{"./helpers":1,"./request":4}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UPLOAD = (data, url = "/images/upload") => fetch(url, {
    method: "POST",
    body: data
}).then(res => res.json());
exports.POST = (url, data) => fetch(url, {
    method: "POST",
    body: data,
    headers: {
        "Content-Type": "application/json"
    }
}).then(res => res.json());
exports.GET = (url) => fetch(url).then(res => res.json());
exports.PUT = (url, data) => fetch(url, {
    method: "PUT",
    body: data,
    headers: {
        "Content-Type": "application/json"
    }
}).then(res => res.json());
exports.DELETE = (url) => fetch(url, { method: "DELETE" }).then(res => res.json());

},{}]},{},[1,2,3,4])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvc2NyaXB0cy90cy9oZWxwZXJzLnRzIiwicHVibGljL3NjcmlwdHMvdHMvbmV3LXByb2plY3QudHMiLCJwdWJsaWMvc2NyaXB0cy90cy9yZXF1ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNFYSxRQUFBLGFBQWEsR0FBRyxDQUFDLEVBQVUsRUFBRSxFQUFFLENBQ3hDLFFBQVEsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFnQyxDQUFDLEtBQUssQ0FBQzs7Ozs7Ozs7O0FDSHJFLHVDQUF5QztBQUV6Qyx1Q0FBMEM7QUFFMUMsTUFBTSxxQkFBcUIsR0FBWSxRQUFRLENBQUMsYUFBYSxDQUMzRCxvQkFBb0IsQ0FDckIsQ0FBQztBQUNGLE1BQU0sY0FBYyxHQUFZLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDaEUsSUFBSSxPQUFPLEdBQVcsRUFBRSxDQUFDO0FBQ3pCLElBQUksY0FBYyxHQUFhLEVBQUUsQ0FBQztBQUVsQyxRQUFRO0tBQ0wsYUFBYSxDQUFDLGNBQWMsQ0FBQztLQUM3QixnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQWlCLEVBQUUsRUFBRTtJQUN0RCxNQUFNLEVBQ0osTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQ2xCLEdBQUcsQ0FBQyxDQUFDO0lBQ04sTUFBTSxRQUFRLEdBQUcsSUFBSSxRQUFRLEVBQUUsQ0FBQztJQUdoQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNyQyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUNwQztJQUVELElBQUk7UUFDRixNQUFNLFFBQVEsR0FBRyxNQUFNLGdCQUFNLENBQUMsUUFBUSxD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QUksRUFBRSxDQUFDLENBQUM7QUFFaEIsUUFBQSxJQUFJLEdBQUcsQ0FBQyxHQUFXLEVBQUUsSUFBdUIsRUFBZ0IsRUFBRSxDQUN6RSxLQUFLLENBQUMsR0FBRyxFQUFFO0lBQ1QsTUFBTSxFQUFFLE1BQU07SUFDZCxJQUFJLEVBQUUsSUFBSTtJQUNWLE9BQU8sRUFBRTtRQUNQLGNBQWMsRUFBRSxrQkFBa0I7S0FDbkM7Q0FDRixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7QUFFaEIsUUFBQSxHQUFHLEdBQUcsQ0FBQyxHQUFXLEVBQWdCLEVBQUUsQ0FDL0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBRXhCLFFBQUEsR0FBRyxHQUFHLENBQUMsR0FBVyxFQUFFLElBQXVCLEVBQWdCLEVBQUUsQ0FDeEUsS0FBSyxDQUFDLEdBQUcsRUFBRTtJQUNULE1BQU0sRUFBRSxLQUFLO0lBQ2IsSUFBSSxFQUFFLElBQUk7SUFDVixPQUFPLEVBQUU7UUFDUCxjQUFjLEVBQUUsa0JBQWtCO0tBQ25DO0NBQ0YsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBRWhCLFFBQUEsTUFBTSxHQUFHLENBQUMsR0FBVyxFQUFnQixFQUFFLENBQ2xELEtBQUssQ0FBQyxHQUFHLEVBQUUsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCB7IEhUTUxJbnB1dEV2ZW50IH0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldEZpZWxkVmFsdWUgPSAoaWQ6IHN0cmluZykgPT5cclxuICAoKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSBhcyB1bmtub3duKSBhcyBIVE1MSW5wdXRFdmVudCkudmFsdWU7XHJcbiIsImltcG9ydCB7IFBPU1QsIFVQTE9BRCB9IGZyb20gXCIuL3JlcXVlc3RcIjtcclxuaW1wb3J0IHsgSFRNTElucHV0RXZlbnQsIElTY3JlZW5zaG90IH0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xyXG5pbXBvcnQgeyBnZXRGaWVsZFZhbHVlIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xyXG5cclxuY29uc3Qgc2NyZWVuc2hvdHNQYXJlbnROb2RlOiBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNzY3JlZW5zaG90c19fbGlzdFwiXHJcbik7XHJcbmNvbnN0IGljb25QYXJlbnROb2RlOiBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pY29uXCIpO1xyXG5sZXQgaWNvblVSTDogc3RyaW5nID0gXCJcIjtcclxubGV0IHNjcmVlbnNob3RVUkxzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuZG9jdW1lbnRcclxuICAucXVlcnlTZWxlY3RvcihcIiNzY3JlZW5zaG90c1wiKVxyXG4gIC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGFzeW5jIChlOiBIVE1MSW5wdXRFdmVudCkgPT4ge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICB0YXJnZXQ6IHsgZmlsZXMgfVxyXG4gICAgfSA9IGU7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG5cclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogcHJlZmVyLWZvci1vZlxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBmb3JtRGF0YS5hcHBlbmQoXCJmaWxlc1wiLCBmaWxlc1tpXSk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBVUExPQUQoZm9ybURhdGEpO1xyXG4gICAgICBjb25zdCB7IHVybHMgfSA9IGF3YWl0IHJlc3BvbnNlO1xyXG4gICAgICBzY3JlZW5zaG90VVJMcyA9IHVybHM7XHJcblxyXG4gICAgICBkcmF3U2NyZWVuc2hvdExpc3Qoc2NyZWVuc2hvdHNQYXJlbnROb2RlLCBzY3JlZW5zaG90VVJMcyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbmRvY3VtZW50XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjaWNvblwiKVxyXG4gIC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGFzeW5jIChlOiBIVE1MSW5wdXRFdmVudCkgPT4ge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICB0YXJnZXQ6IHsgZmlsZXMgfVxyXG4gICAgfSA9IGU7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgZm9ybURhdGEuYXBwZW5kKFwiZmlsZXNcIiwgZmlsZXNbMF0pO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBVUExPQUQoZm9ybURhdGEpO1xyXG4gICAgICBjb25zdCB7XHJcbiAgICAgICAgdXJsczogW3VybF1cclxuICAgICAgfSA9IGRhdGE7XHJcblxyXG4gICAgICBpY29uVVJMID0gdXJsO1xyXG4gICAgICBkcmF3SWNvbihpY29uUGFyZW50Tm9kZSwgdXJsKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctZm9ybVwiKS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGFzeW5jIGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRhdGE6IHN0cmluZyA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgdGl0bGU6IGdldEZpZWxkVmFsdWUoXCJ0aXRsZVwiKSxcclxuICAgICAgZGVzY3JpcHRpb246IGdldEZpZWxkVmFsdWUoXCJkZXNjcmlwdGlvblwiKSxcclxuICAgICAgZ29vZ2xlTGluazogZ2V0RmllbGRWYWx1ZShcImdvb2dsZS1saW5rXCIpLFxyXG4gICAgICBpY29uOiBpY29uVVJMLFxyXG4gICAgICBzY3JlZW5zaG90czogc2NyZWVuc2hvdFVSTHNcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgUE9TVChcIi9wcm9qZWN0c1wiLCBkYXRhKTtcclxuXHJcbiAgICBsb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9XHJcbn0pO1xyXG5cclxuY29uc3QgZHJhZyA9IChlOiBIVE1MSW5wdXRFdmVudCwgdXJsOiBJU2NyZWVuc2hvdCkgPT5cclxuICBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwidGV4dFwiLCBKU09OLnN0cmluZ2lmeSh1cmwpKTtcclxuXHJcbmNvbnN0IGRyb3AgPSAoZTogSFRNTElucHV0RXZlbnQsIGN1cnJlbnRVUkw6IElTY3JlZW5zaG90KSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IG5ld1VSTCA9IEpTT04ucGFyc2UoZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcInRleHRcIikpO1xyXG4gIGNvbnN0IG5ld1NjcmVlbnNob3RVUkxTID0gc2NyZWVuc2hvdFVSTHMubWFwKCh1cmwsIGluZGV4KSA9PiB7XHJcbiAgICBpZiAoaW5kZXggPT09IG5ld1VSTC5pbmRleCkge1xyXG4gICAgICByZXR1cm4gY3VycmVudFVSTC51cmw7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGluZGV4ID09PSBjdXJyZW50VVJMLmluZGV4KSB7XHJcbiAgICAgIHJldHVybiBuZXdVUkwudXJsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB1cmw7XHJcbiAgfSk7XHJcbiAgc2NyZWVuc2hvdFVSTHMgPSBbLi4ubmV3U2NyZWVuc2hvdFVSTFNdO1xyXG5cclxuICBkcmF3U2NyZWVuc2hvdExpc3Qoc2NyZWVuc2hvdHNQYXJlbnROb2RlLCBuZXdTY3JlZW5zaG90VVJMUyk7XHJcbn07XHJcblxyXG5jb25zdCBkcmF3U2NyZWVuc2hvdExpc3QgPSAoc2NyZWVuc2hvdHNOb2RlOiBFbGVtZW50LCB1cmxzOiBzdHJpbmdbXSkgPT4ge1xyXG4gIHdoaWxlIChzY3JlZW5zaG90c05vZGUuZmlyc3RDaGlsZCkge1xyXG4gICAgc2NyZWVuc2hvdHNOb2RlLnJlbW92ZUNoaWxkKHNjcmVlbnNob3RzTm9kZS5maXJzdENoaWxkKTtcclxuICB9XHJcblxyXG4gIHVybHMuZm9yRWFjaCgodXJsLCBpbmRleCkgPT4ge1xyXG4gICAgY29uc3Qgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBjb25zdCBpbWdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcclxuXHJcbiAgICBub2RlLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgIFwiY29sLTZcIixcclxuICAgICAgXCJjb2wtbWQtM1wiLFxyXG4gICAgICBcInNjcmVlbnNob3RzX19saXN0X19pdGVtXCIsXHJcbiAgICAgIGBzY3JlZW5zaG90c19fbGlzdF9faXRlbV9fJHtpbmRleH1gXHJcbiAgICApO1xyXG4gICAgbm9kZS5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgaW1nTm9kZS5zcmMgPSB1cmw7XHJcbiAgICBpbWdOb2RlLmFsdCA9IFwic2NyZWVuc2hvdFwiO1xyXG5cclxuICAgIG5vZGUuYXBwZW5kQ2hpbGQoaW1nTm9kZSk7XHJcbiAgICBzY3JlZW5zaG90c05vZGUuYXBwZW5kQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoYC5zY3JlZW5zaG90c19fbGlzdF9faXRlbV9fJHtpbmRleH1gKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCAoZTogSFRNTElucHV0RXZlbnQpID0+XHJcbiAgICAgICAgZHJhZyhlLCB7IGluZGV4LCB1cmwgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihgLnNjcmVlbnNob3RzX19saXN0X19pdGVtX18ke2luZGV4fWApXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZTogSFRNTElucHV0RXZlbnQpID0+IGRyb3AoZSwgeyBpbmRleCwgdXJsIH0pKTtcclxuXHJcbiAgICBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihgLnNjcmVlbnNob3RzX19saXN0X19pdGVtX18ke2luZGV4fWApXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgKGU6IEhUTUxJbnB1dEV2ZW50KSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgZHJhd0ljb24gPSAoaWNvbk5vZGU6IEVsZW1lbnQsIHVybDogc3RyaW5nKSA9PiB7XHJcbiAgd2hpbGUgKGljb25Ob2RlLmZpcnN0Q2hpbGQpIHtcclxuICAgIGljb25Ob2RlLnJlbW92ZUNoaWxkKGljb25Ob2RlLmZpcnN0Q2hpbGQpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaW1nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XHJcbiAgaW1nTm9kZS5jbGFzc0xpc3QuYWRkKFwiaWNvbl9faXRlbVwiKTtcclxuICBpbWdOb2RlLnNyYyA9IHVybDtcclxuICBpbWdOb2RlLmFsdCA9IFwic2NyZWVuc2hvdFwiO1xyXG4gIGljb25Ob2RlLmFwcGVuZENoaWxkKGltZ05vZGUpO1xyXG59O1xyXG4iLCJleHBvcnQgY29uc3QgVVBMT0FEID0gKFxyXG4gIGRhdGE6IEZvcm1EYXRhLFxyXG4gIHVybDogc3RyaW5nID0gXCIvaW1hZ2VzL3VwbG9hZFwiXHJcbik6IFByb21pc2U8YW55PiA9PlxyXG4gIGZldGNoKHVybCwge1xyXG4gICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgIGJvZHk6IGRhdGFcclxuICB9KS50aGVuKHJlcyA9PiByZXMuanNvbigpKTtcclxuXHJcbmV4cG9ydCBjb25zdCBQT1NUID0gKHVybDogc3RyaW5nLCBkYXRhOiBGb3JtRGF0YSB8IHN0cmluZyk6IFByb21pc2U8YW55PiA9PlxyXG4gIGZldGNoKHVybCwge1xyXG4gICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgIGJvZHk6IGRhdGEsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICB9XHJcbiAgfSkudGhlbihyZXMgPT4gcmVzLmpzb24oKSk7XHJcblxyXG5leHBvcnQgY29uc3QgR0VUID0gKHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+ID0+XHJcbiAgZmV0Y2godXJsKS50aGVuKHJlcyA9PiByZXMuanNvbigpKTtcclxuXHJcbmV4cG9ydCBjb25zdCBQVVQgPSAodXJsOiBzdHJpbmcsIGRhdGE6IEZvcm1EYXRhIHwgc3RyaW5nKTogUHJvbWlzZTxhbnk+ID0+XHJcbiAgZmV0Y2godXJsLCB7XHJcbiAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICBib2R5OiBkYXRhLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG4gIH0pLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFTEVURSA9ICh1cmw6IHN0cmluZyk6IFByb21pc2U8YW55PiA9PlxyXG4gIGZldGNoKHVybCwgeyBtZXRob2Q6IFwiREVMRVRFXCIgfSkudGhlbihyZXMgPT4gcmVzLmpzb24oKSk7XHJcbiJdfQ==
